<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile</title>
  <script src="./helper.js"></script>
</head>
<body>

  <h1>salam</h1>
  <p id="userInfo"></p>

  <script>
    async function checkToken() {
      const token = getCookie("access_token");

      if (!token) {
        alert("token yoxdu");
        window.location.href = "index.html";
        return;
      }

      try {
        const res = await fetch("https://guest-api.garakhanov.az/api/auth/me", {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });

        if (!res.ok) throw new Error("login ol");

      
        const data = await res.json();

       
        const firstName = data.firstName || data.data?.firstName || "";
        const lastName  = data.lastName  || data.data?.lastName  || "";

        document.getElementById("userInfo").textContent =
          `${firstName} ${lastName}`;

        alert("token duz");

      } catch (err) {
        alert("login ol");
        window.location.href = "index.html";
      }
    }

    checkToken();
  </script>
</body>
</html>
